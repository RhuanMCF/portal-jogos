<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üöÄ SPACE INVADERS - Brick Game 9999 in 1</title>
  <style>
    body { margin: 0; padding: 20px; background: #000; color: lime; font-family: 'Courier New', monospace; text-align: center; }
    h1 { font-size: 2em; margin-bottom: 10px; }
    #hud { display: flex; justify-content: space-around; align-items: center; margin-bottom: 10px; font-size: 1.2em; font-weight: bold; }
    canvas { border: 3px solid lime; background: #111; display: block; margin: 0 auto; image-rendering: pixelated; }
    .leaderboard { margin-top: 20px; padding: 15px; border: 2px solid #333; max-width: 600px; margin: 20px auto; }
    .best-score { display: block; font-size: 1.1em; margin: 5px 0; color: #90EE90; }
    button { background: lime; color: black; border: none; padding: 10px 20px; font-size: 1em; font-weight: bold; cursor: pointer; border-radius: 5px; }
    button:hover { background: #32CD32; }
    #game-over { font-size: 1.5em; color: red; margin: 10px 0; }
  </style>
</head>
<body>
  <h1>üöÄ SPACE INVADERS - Brick Game 9999 in 1</h1>
  <div id="hud">
    <span id="score">SCORE: 0</span>
    <span id="lives">VIDAS: 3</span>
    <span id="wave">ONDA: 1</span>
    <button id="reset">üîÑ RESET</button>
  </div>
  <canvas id="gc" width="600" height="600"></canvas>
  <div id="game-over" style="display:none;"></div>
  <div class="leaderboard">
    <h3>üèÜ TOP 5 RECORDES</h3>
    <div id="scores">
      <span class="best-score">1. --- : 0</span>
      <span class="best-score">2. --- : 0</span>
      <span class="best-score">3. --- : 0</span>
      <span class="best-score">4. --- : 0</span>
      <span class="best-score">5. --- : 0</span>
    </div>
  </div>

  <script>
    var InvadersGame;

    (function () {
      const COLS = 15, ROWS = 15, TILE = 40;
      var canv, ctx;
      var ship = { x: 7, y: 14 };
      var bullets = [];
      var aliens = [];
      var alienDir = 1, alienDrop = 0;
      var score = 0, lives = 3, wave = 1;
      var gameRunning = true;
      var keys = {};
      var bestScores = [];

      function loadBestScores() {
        try {
          const saved = localStorage.getItem('invadersBestScores');
          bestScores = saved ? JSON.parse(saved) : Array(5).fill({name:'---',score:0});
        } catch { bestScores = Array(5).fill({name:'---',score:0}); }
        updateScoresDisplay();
      }

      function saveBestScores() {
        try { localStorage.setItem('invadersBestScores', JSON.stringify(bestScores)); } catch(e) {}
      }

      function updateScoresDisplay() {
        document.querySelectorAll('.best-score').forEach((el,i) => {
          el.textContent = `${i+1}. ${bestScores[i]?.name || '---'} : ${bestScores[i]?.score || 0}`;
        });
      }

      function addScore(name, sc) {
        bestScores.push({name, score:sc});
        bestScores.sort((a,b)=>b.score - a.score).splice(5);
        saveBestScores();
        updateScoresDisplay();
      }

      function reset() {
        ship.x = 7; ship.y = 14;
        bullets = [];
        initAliens();
        score = 0; lives = 3; wave = 1; alienDir = 1; alienDrop = 0;
        gameRunning = true;
        updateHUD();
        document.getElementById('game-over').style.display = 'none';
      }

      function updateHUD() {
        document.getElementById('score').textContent = `SCORE: ${score}`;
        document.getElementById('lives').textContent = `VIDAS: ${lives}`;
        document.getElementById('wave').textContent = `ONDA: ${wave}`;
      }

      function initAliens() {
        aliens = [];
        for (let row = 0; row < 5; row++) {
          for (let col = 0; col < 11; col++) {
            aliens.push({
              x: 2 + col,
              y: 2 + row,
              alive: true,
              type: row % 3
            });
          }
        }
      }

      function update() {
        if (!gameRunning) return;

        // Move aliens
        let edge = false;
        aliens.forEach(alien => {
          if (!alien.alive) return;
          alien.x += alienDir;
          if (alien.x <= 0 || alien.x >= COLS - 1) edge = true;
        });

        if (edge) {
          alienDir = -alienDir;
          alienDrop++;
          aliens.forEach(alien => {
            if (alien.alive) alien.y++;
          });
        }

        // Alien shooting
        if (Math.random() < 0.02) {
          const aliveAliens = aliens.filter(a => a.alive);
          if (aliveAliens.length > 0) {
            const shooter = aliveAliens[Math.floor(Math.random() * aliveAliens.length)];
            bullets.push({ x: shooter.x, y: shooter.y + 1, vy: 1, player: false });
          }
        }

        // Move bullets
        bullets.forEach((bullet, i) => {
          bullet.y += bullet.vy;
          if (bullet.y < 0 || bullet.y > ROWS) {
            bullets.splice(i, 1);
            return;
          }

          // Bullet collisions
          if (bullet.player) {
            // Player bullet hits alien
            aliens.forEach(alien => {
              if (alien.alive && alien.x === bullet.x && alien.y === bullet.y) {
                alien.alive = false;
                bullets.splice(i, 1);
                score += 10 * (3 - alien.type);
              }
            });
          } else {
            // Alien bullet hits player
            if (bullet.x === ship.x && bullet.y === ship.y) {
              lives--;
              bullets.splice(i, 1);
              if (lives <= 0) gameOver();
            }
          }
        });

        // Check win condition
        if (aliens.every(a => !a.alive)) {
          wave++;
          initAliens();
          alienDrop = 0;
        }

        // Check lose condition (aliens reach bottom)
        if (aliens.some(a => a.alive && a.y >= ship.y)) {
          gameOver();
        }

        updateHUD();
      }

      function draw() {
        ctx.fillStyle = '#111';
        ctx.fillRect(0, 0, 600, 600);

        // Draw aliens
        aliens.forEach(alien => {
          if (!alien.alive) return;
          const colors = ['#FF0000', '#FFFF00', '#00FF00'];
          ctx.fillStyle = colors[alien.type];
          ctx.fillRect(alien.x * TILE + 5, alien.y * TILE + 5, TILE - 10, TILE - 10);
        });

        // Draw bullets
        bullets.forEach(bullet => {
          ctx.fillStyle = bullet.player ? '#FFFFFF' : '#FFFF00';
          ctx.fillRect(bullet.x * TILE + TILE/2 - 2, bullet.y * TILE, 4, 8);
        });

        // Draw ship
        ctx.fillStyle = '#00FFFF';
        ctx.fillRect(ship.x * TILE + 5, ship.y * TILE + 5, TILE - 10, TILE - 10);
        // Ship details
        ctx.fillStyle = '#008888';
        ctx.fillRect(ship.x * TILE + 10, ship.y * TILE + 10, TILE - 20, TILE - 20);
      }

      function gameOver() {
        gameRunning = false;
        const goEl = document.getElementById('game-over');
        goEl.innerHTML = `GAME OVER! Score: ${score} | <button onclick="InvadersGame.saveHigh()">üíæ Salvar Record</button>`;
        goEl.style.display = 'block';
      }

      // Handle input
      function handleInput() {
        if (keys['ArrowLeft'] && ship.x > 0) ship.x--;
        if (keys['ArrowRight'] && ship.x < COLS - 1) ship.x++;
        if (keys[' '] && bullets.filter(b => b.player).length < 3) {
          bullets.push({ x: ship.x, y: ship.y - 1, vy: -1, player: true });
          keys[' '] = false;
        }
      }

      function loop() {
        handleInput();
        update();
        draw();
        requestAnimationFrame(loop);
      }

      // Events
      document.addEventListener('keydown', e => {
        keys[e.key] = true;
      });
      document.addEventListener('keyup', e => {
        keys[e.key] = false;
      });

      window.InvadersGame = {
        init: function() {
          canv = document.getElementById('gc');
          ctx = canv.getContext('2d');
          loadBestScores();
          reset();
          document.getElementById('reset').onclick = reset;
          loop();
        },
        saveHigh: function() {
          const name = prompt('Nome pro recorde:');
          if (name && name.trim()) {
            const cleanName = name.trim();
            const userBest = bestScores.filter(r => r.name === cleanName).reduce((max, r) => Math.max(max, r.score), 0);
            if (score <= userBest && userBest > 0) {
              const funny = ["üöÄ Aliens invadiram seu recorde! Tenta de novo! üëæ", "üòÖ Naves te cercaram! üí™", "üí• Game over gal√°ctico! üîÑ"];
              alert(funny[Math.floor(Math.random()*funny.length)]);
              return;
            }
            addScore(cleanName, score);
            alert('Recorde salvo! üèÜ');
          }
        }
      };

      InvadersGame = window.InvadersGame;
    })();

    window.onload = function() {
      InvadersGame.init();
    };
  </script>
</body>
</html>